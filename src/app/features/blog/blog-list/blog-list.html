<div class="relative overflow-hidden bg-[var(--brand-950)]/0">
  <!-- soft blobs background (NEW palette) -->
  <div class="pointer-events-none absolute inset-0">
    <div class="absolute -top-28 -left-28 h-[560px] w-[560px] rounded-full bg-[var(--brand-300)]/55 blur-3xl"></div>
    <div class="absolute -bottom-28 -right-28 h-[560px] w-[560px] rounded-full bg-[var(--brand-200)]/35 blur-3xl"></div>
    <div class="absolute top-1/3 right-1/4 h-[420px] w-[420px] rounded-full bg-[var(--brand-500)]/14 blur-3xl"></div>
  </div>

  <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-14 md:py-20 relative">
    <div class="max-w-7xl mx-auto">

      <!-- Breadcrumb -->
      <nav class="text-sm mb-8" style="color: color-mix(in srgb, var(--brand-600) 85%, transparent);">
        <a routerLink="/" class="hover:opacity-80 transition" style="color: var(--brand-600);">Inicio</a>
        <span class="mx-2" style="color: color-mix(in srgb, var(--brand-600) 55%, transparent);">/</span>
        <span class="font-semibold" style="color: var(--brand-950);">Blog</span>
      </nav>

      <!-- Header -->
      <header class="text-center max-w-3xl mx-auto mb-10 md:mb-12">
        <span
          class="inline-flex items-center gap-2 rounded-full px-4 py-2 text-xs font-extrabold tracking-wide bg-white/70 backdrop-blur border"
          style="color: var(--brand-950); border-color: color-mix(in srgb, var(--brand-200) 55%, transparent);"
        >
          <span class="h-2 w-2 rounded-full bg-[var(--brand-500)]"></span>
          Blog · Salud y Neurocirugía
        </span>

        <h1 class="mt-5 text-4xl md:text-5xl font-extrabold leading-[1.05] text-balance" style="color: var(--brand-950);">
          Artículos claros sobre Cerebro y Columna
        </h1>

        <p class="mt-4 text-lg md:text-xl leading-relaxed text-pretty" style="color: color-mix(in srgb, var(--brand-800) 72%, transparent);">
          Contenido informativo para ayudarte a entender tus síntomas, opciones de tratamiento y
          cuidados preventivos con un enfoque práctico y basado en evidencia.
        </p>
      </header>

      <!-- Estados -->
      @if (loading()) {
        <div class="max-w-4xl mx-auto">
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            @for (_ of [1,2,3,4,5,6]; track $index) {
              <div
                class="rounded-2xl bg-white/80 backdrop-blur p-6 shadow-sm border"
                style="border-color: color-mix(in srgb, var(--brand-200) 55%, transparent);"
              >
                <div class="animate-pulse">
                  <div class="h-6 w-24 rounded-full mb-4"
                       style="background: color-mix(in srgb, var(--brand-200) 55%, white);"></div>
                  <div class="h-6 rounded-lg mb-3 w-5/6"
                       style="background: color-mix(in srgb, var(--brand-200) 55%, white);"></div>
                  <div class="h-4 rounded-lg mb-2 w-full"
                       style="background: color-mix(in srgb, var(--brand-200) 45%, white);"></div>
                  <div class="h-4 rounded-lg mb-5 w-4/5"
                       style="background: color-mix(in srgb, var(--brand-200) 45%, white);"></div>
                  <div class="h-4 w-28 rounded-lg"
                       style="background: color-mix(in srgb, var(--brand-200) 45%, white);"></div>
                </div>
              </div>
            }
          </div>
        </div>

      } @else if (error()) {
        <div
          class="max-w-3xl mx-auto text-center rounded-2xl p-5 border bg-white/80 backdrop-blur"
          style="border-color: color-mix(in srgb, var(--brand-200) 65%, transparent); color: color-mix(in srgb, var(--brand-950) 70%, black);"
        >
          {{ error() }}
        </div>

      } @else {

        <!-- Tags -->
        <div class="flex flex-wrap gap-3 justify-center mb-10 md:mb-12">
          @for (tag of tags(); track tag) {
            <button
              type="button"
              (click)="setTag(tag)"
              class="group inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-extrabold transition border"
              [class.text-white]="selectedTag() === tag"
              [class.bg-transparent]="selectedTag() === tag"
              [class.bg-white]="selectedTag() !== tag"
              [class.hover:opacity-90]="selectedTag() === tag"
              [class.hover:bg-white]="selectedTag() !== tag"
              [class.hover:opacity-90]="selectedTag() !== tag"
              [ngStyle]="selectedTag() === tag
                ? {
                    'background': 'linear-gradient(90deg, var(--brand-950), var(--brand-800))',
                    'border-color': 'color-mix(in srgb, var(--brand-200) 40%, transparent)'
                  }
                : {
                    'color': 'var(--brand-950)',
                    'border-color': 'color-mix(in srgb, var(--brand-200) 55%, transparent)',
                    'background': 'rgba(255,255,255,.9)'
                  }"
            >
              <span
                class="h-2 w-2 rounded-full"
                [style.background]="selectedTag() === tag
                  ? 'var(--brand-300)'
                  : 'color-mix(in srgb, var(--brand-200) 75%, transparent)'"
              ></span>
              {{ tag }}
            </button>
          }
        </div>

        <!-- Empty -->
        @if (filteredPosts().length === 0) {
          <div
            class="max-w-3xl mx-auto text-center rounded-2xl bg-white/80 backdrop-blur p-8 border"
            style="border-color: color-mix(in srgb, var(--brand-200) 55%, transparent); color: color-mix(in srgb, var(--brand-800) 70%, transparent);"
          >
            No hay artículos para este filtro por ahora.
          </div>
        } @else {

          <!-- Posts grid -->
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            @for (post of filteredPosts(); track post.slug) {
              <article class="group h-full">
                <a
                  [routerLink]="['/blog', post.slug]"
                  class="relative block h-full rounded-2xl bg-white/85 backdrop-blur p-6 shadow-sm hover:shadow-xl hover:-translate-y-1 transition overflow-hidden border"
                  style="border-color: color-mix(in srgb, var(--brand-200) 55%, transparent);"
                >
                  <!-- hover glow -->
                  <div class="pointer-events-none absolute inset-0 opacity-0 group-hover:opacity-100 transition">
                    <div class="absolute -top-10 -right-10 h-40 w-40 rounded-full bg-[var(--brand-300)]/38 blur-3xl"></div>
                    <div class="absolute -bottom-12 -left-12 h-44 w-44 rounded-full bg-[var(--brand-500)]/18 blur-3xl"></div>
                  </div>

                  <!-- Tag badge -->
                  <div
                    class="relative inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-extrabold bg-white/80 border mb-4"
                    style="color: var(--brand-950); border-color: color-mix(in srgb, var(--brand-200) 55%, transparent);"
                  >
                    <lucide-icon [img]="iTag" class="w-3.5 h-3.5"></lucide-icon>
                    {{ post.tag }}
                  </div>

                  <h2 class="relative text-xl font-extrabold leading-snug mb-3 text-balance" style="color: var(--brand-950);">
                    {{ post.title }}
                  </h2>

                  <p class="relative text-sm leading-relaxed text-pretty mb-5"
                     style="color: color-mix(in srgb, var(--brand-800) 70%, transparent);">
                    {{ post.excerpt }}
                  </p>

                  <div class="relative flex items-center justify-between gap-3 mt-auto">
                    <div class="flex items-center gap-4 text-xs"
                         style="color: color-mix(in srgb, var(--brand-600) 85%, transparent);">
                      <span class="inline-flex items-center gap-1">
                        <lucide-icon [img]="iCalendar" class="w-3.5 h-3.5"></lucide-icon>
                        {{ formatDate(post.published_at) }}
                      </span>

                      <span class="inline-flex items-center gap-1">
                        <lucide-icon [img]="iClock" class="w-3.5 h-3.5"></lucide-icon>
                        {{ post.read_time }}
                      </span>
                    </div>

                    <div class="inline-flex items-center gap-2 text-sm font-extrabold" style="color: var(--brand-500);">
                      Leer
                      <span
                        class="inline-flex h-8 w-8 items-center justify-center rounded-full border bg-white/80"
                        style="border-color: color-mix(in srgb, var(--brand-200) 55%, transparent);"
                      >
                        <span class="font-extrabold" style="color: var(--brand-500);">→</span>
                      </span>
                    </div>
                  </div>

                  <!-- tiny rail (no orange) -->
                  <div class="mt-5 h-1 w-full rounded-full"
                       style="background: linear-gradient(90deg, var(--brand-950), var(--brand-800), var(--brand-500), var(--brand-300));">
                  </div>
                </a>
              </article>
            }
          </div>

        }
      }
    </div>
  </div>
</div>
