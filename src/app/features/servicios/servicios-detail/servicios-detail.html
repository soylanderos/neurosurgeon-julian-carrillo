<section class="relative overflow-hidden bg-[var(--brand-950)]/0">
  <!-- Background decor (NEW palette only) -->
  <div class="pointer-events-none absolute inset-0">
    <div class="absolute -top-32 -left-28 h-[520px] w-[520px] rounded-full bg-[var(--brand-300)]/55 blur-3xl"></div>
    <div class="absolute top-32 -right-28 h-[560px] w-[560px] rounded-full bg-[var(--brand-500)]/18 blur-3xl"></div>
    <div class="absolute bottom-0 left-1/3 h-[520px] w-[520px] rounded-full bg-[var(--brand-200)]/30 blur-3xl"></div>

    <div
      class="absolute inset-0 opacity-[0.08]"
      style="background-image: radial-gradient(color-mix(in srgb, var(--brand-800) 70%, transparent) 0.6px, transparent 0.6px); background-size: 18px 18px;"
    ></div>
  </div>

  <div class="relative container mx-auto px-4 sm:px-6 lg:px-8 py-14 md:py-20 max-w-6xl">
    @if (error()) {
      <div
        class="rounded-[2rem] bg-white/80 backdrop-blur p-6 text-center text-red-700 shadow-sm"
        style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent);"
      >
        {{ error() }}
      </div>
    } @else {

      @if (loading()) {
        <div class="text-[var(--brand-600)]">Cargando…</div>
      } @else {

        @if (servicio(); as s) {

          <!-- Breadcrumb (pill) -->
          <nav class="text-sm mb-6">
            <div
              class="inline-flex items-center gap-2 rounded-full bg-white/70 backdrop-blur px-4 py-2 shadow-sm"
              style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent); color: color-mix(in srgb, var(--brand-800) 80%, transparent);"
            >
              <a routerLink="/" class="hover:opacity-80 transition" style="color: var(--brand-600);">Inicio</a>
              <span style="color: color-mix(in srgb, var(--brand-600) 55%, transparent);">/</span>
              <a routerLink="/servicios" class="hover:opacity-80 transition" style="color: var(--brand-600);">Servicios</a>
              <span style="color: color-mix(in srgb, var(--brand-600) 55%, transparent);">/</span>
              <span class="font-extrabold" style="color: var(--brand-950);">{{ s.breadcrumb }}</span>
            </div>
          </nav>

          <!-- HERO -->
          <header
            class="relative overflow-hidden rounded-[2rem] bg-white/70 backdrop-blur-xl
                   shadow-[0_30px_90px_-55px_rgba(5,10,48,.55)]"
            style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent);"
          >
            <!-- accents -->
            <div class="pointer-events-none absolute inset-0">
              <div class="absolute -top-16 -right-20 h-72 w-72 rounded-full bg-[var(--brand-500)]/14 blur-3xl"></div>
              <div class="absolute -bottom-24 -left-20 h-80 w-80 rounded-full bg-[var(--brand-300)]/26 blur-3xl"></div>
              <div class="absolute inset-x-0 top-0 h-24 bg-gradient-to-b from-white/70 to-transparent"></div>
            </div>

            <div class="relative p-7 md:p-10">
              <div class="grid lg:grid-cols-[1fr_380px] gap-8 items-start">
                <!-- LEFT -->
                <div>
                  <div class="flex items-center justify-between gap-4 flex-wrap">
                    <span
                      class="inline-flex items-center gap-2 rounded-full bg-white/85 px-3 py-1 text-xs font-extrabold"
                      style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: color-mix(in srgb, var(--brand-800) 85%, transparent);"
                    >
                      <span class="h-2 w-2 rounded-full bg-[var(--brand-500)]"></span>
                      Servicio
                    </span>

                    <!-- TOC pills -->
                    <div class="hidden md:flex items-center gap-2 text-xs">
                      <a
                        [routerLink]="[]"
                        fragment="sintomas"
                        class="rounded-full bg-white/85 px-3 py-1 hover:opacity-80 transition"
                        style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: color-mix(in srgb, var(--brand-800) 80%, transparent);"
                      >
                        Síntomas
                      </a>
                      <a
                        [routerLink]="[]"
                        fragment="tratamientos"
                        class="rounded-full bg-white/85 px-3 py-1 hover:opacity-80 transition"
                        style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: color-mix(in srgb, var(--brand-800) 80%, transparent);"
                      >
                        Tratamientos
                      </a>
                      <a
                        [routerLink]="[]"
                        fragment="faq"
                        class="rounded-full bg-white/85 px-3 py-1 hover:opacity-80 transition"
                        style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: color-mix(in srgb, var(--brand-800) 80%, transparent);"
                      >
                        Preguntas
                      </a>
                    </div>
                  </div>

                  <h1 class="mt-4 text-4xl md:text-5xl font-black tracking-tight text-balance leading-[1.05]" style="color: var(--brand-950);">
                    {{ s.title }}
                  </h1>

                  <p class="mt-4 text-lg md:text-xl font-extrabold text-pretty" style="color: var(--brand-500);">
                    {{ s.subtitle }}
                  </p>

                  <p class="mt-4 text-lg leading-relaxed text-pretty" style="color: color-mix(in srgb, var(--brand-800) 72%, transparent);">
                    {{ s.description }}
                  </p>

                  <div class="mt-6 flex flex-col sm:flex-row gap-3">
                    <a
                      routerLink="/cita"
                      class="inline-flex items-center justify-center rounded-2xl px-5 py-3 text-white font-extrabold shadow-sm hover:brightness-110 transition"
                      style="background: var(--brand-950);"
                    >
                      Agendar cita
                    </a>

                    <a
                      [routerLink]="[]"
                      fragment="tratamientos"
                      class="inline-flex items-center justify-center rounded-2xl bg-white/90 px-5 py-3 font-extrabold hover:opacity-90 transition"
                      style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: var(--brand-950);"
                    >
                      Ver tratamientos
                    </a>
                  </div>

                  <div class="mt-7 h-px w-full" style="background: linear-gradient(90deg, transparent, color-mix(in srgb, var(--brand-200) 70%, transparent), transparent);"></div>

                  <!-- mini stats -->
                  <div class="mt-6 grid sm:grid-cols-3 gap-3">
                    <div class="rounded-2xl bg-white/85 p-4" style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent);">
                      <div class="text-xs font-extrabold tracking-wide" style="color: color-mix(in srgb, var(--brand-600) 85%, transparent);">ENFOQUE</div>
                      <div class="mt-1 text-sm font-extrabold" style="color: var(--brand-950);">Evaluación integral</div>
                    </div>
                    <div class="rounded-2xl bg-white/85 p-4" style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent);">
                      <div class="text-xs font-extrabold tracking-wide" style="color: color-mix(in srgb, var(--brand-600) 85%, transparent);">PLAN</div>
                      <div class="mt-1 text-sm font-extrabold" style="color: var(--brand-950);">Por etapas, sin humo</div>
                    </div>
                    <div class="rounded-2xl bg-white/85 p-4" style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent);">
                      <div class="text-xs font-extrabold tracking-wide" style="color: color-mix(in srgb, var(--brand-600) 85%, transparent);">OBJETIVO</div>
                      <div class="mt-1 text-sm font-extrabold" style="color: var(--brand-950);">Seguridad y recuperación</div>
                    </div>
                  </div>
                </div>

                <!-- RIGHT: image card -->
                <div class="relative">
                  <div
                    class="rounded-[2rem] p-[1px]"
                    style="background: linear-gradient(135deg,
                      color-mix(in srgb, var(--brand-500) 28%, transparent),
                      color-mix(in srgb, var(--brand-300) 55%, transparent),
                      color-mix(in srgb, var(--brand-200) 40%, transparent)
                    );"
                  >
                    <div class="relative overflow-hidden rounded-[2rem] bg-white/80 backdrop-blur shadow-sm"
                         style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent);">
                      <div class="absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent"></div>

                      <img
                        src="https://hospitalangeles.com/assets/img/medicos/julian-octavio-carrillo-gonzalez.jpg"
                        alt="Dr. Julián Octavio Carrillo"
                        class="h-[280px] w-full object-cover object-[50%_20%]"
                        loading="lazy"
                        decoding="async"
                        referrerpolicy="no-referrer"
                      />

                      <div class="relative p-5">
                        <p class="text-xs font-extrabold tracking-wide" style="color: color-mix(in srgb, var(--brand-600) 85%, transparent);">ORIENTACIÓN</p>
                        <p class="mt-1 text-sm leading-relaxed" style="color: color-mix(in srgb, var(--brand-800) 72%, transparent);">
                          Si tienes estudios previos, llévalos. Acelera decisiones y evita vueltas innecesarias.
                        </p>

                        <div class="mt-4 grid grid-cols-2 gap-2">
                          <div class="rounded-2xl bg-white/85 p-3" style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent);">
                            <div class="flex items-center gap-2 text-xs font-extrabold" style="color: color-mix(in srgb, var(--brand-800) 80%, transparent);">
                              <span class="h-2 w-2 rounded-full bg-[var(--brand-500)]"></span>
                              Brain &amp; Spine
                            </div>
                          </div>
                          <div class="rounded-2xl bg-white/85 p-3" style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent);">
                            <div class="flex items-center gap-2 text-xs font-extrabold" style="color: color-mix(in srgb, var(--brand-800) 80%, transparent);">
                              <span class="h-2 w-2 rounded-full bg-[var(--brand-300)]"></span>
                              Plan por etapas
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- rail -->
                      <div class="h-1.5 w-full" style="background: linear-gradient(90deg, var(--brand-950), var(--brand-800), var(--brand-500), var(--brand-300));"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </header>

          <!-- MAIN + SIDEBAR -->
          <div class="mt-10 grid lg:grid-cols-[1fr_360px] gap-8 lg:gap-10">
            <!-- MAIN -->
            <main class="space-y-8">
              <!-- sintomas -->
              <section
                id="sintomas"
                class="scroll-mt-28 rounded-[2rem] bg-white/80 backdrop-blur p-7 md:p-8"
                style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent); box-shadow: 0 14px 40px -26px rgba(5,10,48,.22);"
              >
                <div class="flex items-end justify-between gap-6 flex-wrap">
                  <div>
                    <h2 class="text-2xl md:text-3xl font-black" style="color: var(--brand-950);">
                      {{ s.symptoms_title || 'Síntomas comunes' }}
                    </h2>
                    <p class="mt-2" style="color: color-mix(in srgb, var(--brand-600) 90%, transparent);">
                      Si presentas uno o más, conviene valoración para definir el siguiente paso.
                    </p>
                  </div>

                  <a
                    [routerLink]="[]"
                    fragment="faq"
                    class="text-sm font-extrabold hover:opacity-80 transition"
                    style="color: var(--brand-500);"
                  >
                    Ver FAQ →
                  </a>
                </div>

                <div class="mt-6 grid md:grid-cols-2 gap-3 items-stretch">
                  @for (item of s.symptoms; track item) {
                    <div class="group rounded-2xl bg-white/75 p-4 hover:bg-white transition"
                         style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent);">
                      <div class="flex items-start gap-3">
                        <span class="mt-1 inline-block h-2.5 w-2.5 rounded-full bg-[var(--brand-500)]"></span>
                        <p class="leading-relaxed" style="color: color-mix(in srgb, var(--brand-800) 72%, transparent);">{{ item }}</p>
                      </div>
                    </div>
                  }
                </div>
              </section>

              <!-- tratamientos -->
              <section
                id="tratamientos"
                class="scroll-mt-28 rounded-[2rem] bg-white/80 backdrop-blur p-7 md:p-8"
                style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent); box-shadow: 0 14px 40px -26px rgba(5,10,48,.22);"
              >
                <div>
                  <h2 class="text-2xl md:text-3xl font-black" style="color: var(--brand-950);">
                    {{ s.treatments_title || 'Opciones de tratamiento' }}
                  </h2>
                  <p class="mt-2" style="color: color-mix(in srgb, var(--brand-600) 90%, transparent);">
                    El plan depende del diagnóstico, estudios y objetivos clínicos.
                  </p>
                </div>

                <div class="mt-6 space-y-3">
                  @for (t of s.treatments; track t; let i = $index) {
                    <div class="relative overflow-hidden rounded-2xl bg-white/85 p-5 hover:shadow-sm transition"
                         style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent);">
                      <div class="flex items-start gap-4">
                        <div class="shrink-0">
                          <div
                            class="h-9 w-9 rounded-2xl text-white flex items-center justify-center text-sm font-black"
                            style="background: var(--brand-950);"
                          >
                            {{ i + 1 }}
                          </div>
                        </div>
                        <div class="flex-1">
                          <p class="leading-relaxed" style="color: color-mix(in srgb, var(--brand-800) 72%, transparent);">{{ t }}</p>
                        </div>
                      </div>

                      <div class="pointer-events-none absolute -top-10 -right-10 h-28 w-28 rounded-full bg-[var(--brand-300)]/40 blur-2xl"></div>
                      <div class="pointer-events-none absolute -bottom-10 -left-10 h-28 w-28 rounded-full bg-[var(--brand-200)]/25 blur-2xl"></div>
                    </div>
                  }
                </div>
              </section>

              <!-- faq -->
              <section
                id="faq"
                class="scroll-mt-28 rounded-[2rem] bg-white/80 backdrop-blur p-7 md:p-8"
                style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent); box-shadow: 0 14px 40px -26px rgba(5,10,48,.22);"
              >
                <div class="flex items-end justify-between gap-6 flex-wrap">
                  <div>
                    <h2 class="text-2xl md:text-3xl font-black" style="color: var(--brand-950);">Preguntas frecuentes</h2>
                    <p class="mt-2" style="color: color-mix(in srgb, var(--brand-600) 90%, transparent);">Respuestas claras para decidir con confianza.</p>
                  </div>

                  <a
                    [routerLink]="[]"
                    fragment="sintomas"
                    class="text-sm font-extrabold hover:opacity-80 transition"
                    style="color: var(--brand-600);"
                  >
                    Volver ↑
                  </a>
                </div>

                <div class="mt-6 space-y-3">
                  @for (f of s.faqs; track f.question) {
                    <details class="group rounded-2xl bg-white/85 open:bg-white transition"
                             style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent);">
                      <summary class="cursor-pointer list-none p-5 flex items-start justify-between gap-4">
                        <h3 class="font-extrabold leading-relaxed" style="color: var(--brand-950);">
                          {{ f.question }}
                        </h3>

                        <span
                          class="mt-0.5 shrink-0 inline-flex h-9 w-9 items-center justify-center rounded-full bg-white transition-transform group-open:rotate-45"
                          style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent); color: var(--brand-950);"
                        >
                          <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                          </svg>
                        </span>
                      </summary>

                      <div class="px-5 pb-5 leading-relaxed" style="color: color-mix(in srgb, var(--brand-800) 70%, transparent);">
                        {{ f.answer }}
                      </div>
                    </details>
                  }
                </div>
              </section>
            </main>

            <!-- SIDEBAR -->
            <aside class="lg:sticky lg:top-6 h-fit space-y-6">
              <!-- CTA bento -->
              <div class="rounded-[2rem] bg-white/70 backdrop-blur-xl shadow-sm overflow-hidden"
                   style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent);">
                <div class="p-6">
                  <p class="text-xs font-extrabold tracking-wide" style="color: var(--brand-500);">SIGUIENTE PASO</p>
                  <h3 class="mt-1 text-lg font-black" style="color: var(--brand-950);">Agenda una valoración</h3>
                  <p class="mt-2 text-sm" style="color: color-mix(in srgb, var(--brand-600) 90%, transparent);">
                    Si tienes síntomas o dudas, una valoración define el plan con claridad.
                  </p>

                  <div class="mt-5 space-y-3">
                    <a
                      routerLink="/contacto"
                      class="w-full inline-flex items-center justify-center rounded-2xl px-5 py-3 text-white font-extrabold hover:brightness-110 transition"
                      style="background: var(--brand-950); box-shadow: 0 18px 50px -30px rgba(5,10,48,.65);"
                    >
                      Agendar cita
                    </a>

                    <a
                      routerLink="/contacto"
                      class="w-full inline-flex items-center justify-center rounded-2xl bg-white/90 px-5 py-3 font-extrabold hover:opacity-90 transition"
                      style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: var(--brand-950);"
                    >
                      Contacto
                    </a>
                  </div>

                  <div class="mt-6 rounded-2xl bg-white/85 p-4"
                       style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent);">
                    <p class="text-xs font-extrabold tracking-wide" style="color: color-mix(in srgb, var(--brand-600) 85%, transparent);">TIP</p>
                    <p class="mt-1 text-sm" style="color: color-mix(in srgb, var(--brand-800) 75%, transparent);">
                      Anota síntomas + fechas y lleva estudios previos (si tienes).
                    </p>
                  </div>
                </div>

                <div class="h-1.5 w-full" style="background: linear-gradient(90deg, var(--brand-950), var(--brand-800), var(--brand-500), var(--brand-300));"></div>
              </div>

              <!-- Alarm / warning (NO orange) -->
              <div class="rounded-[2rem] backdrop-blur p-6"
                   style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent); background: color-mix(in srgb, var(--brand-200) 18%, white 82%);">
                <div class="flex items-start justify-between gap-4">
                  <div>
                    <h3 class="text-lg font-black" style="color: var(--brand-950);">Señales de alarma</h3>
                    <p class="mt-2 text-sm leading-relaxed" style="color: color-mix(in srgb, var(--brand-800) 75%, transparent);">
                      {{ s.warning_text }}
                    </p>
                  </div>

                  <div class="h-10 w-10 rounded-2xl bg-white/75 flex items-center justify-center"
                       style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent); color: var(--brand-950);">
                    <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                      <path d="M12 9v5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      <path d="M12 17h.01" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                      <path
                        d="M10.3 4.5 2.6 18a2 2 0 0 0 1.7 3h15.4a2 2 0 0 0 1.7-3L13.7 4.5a2 2 0 0 0-3.4 0Z"
                        stroke="currentColor" stroke-width="2" stroke-linejoin="round"
                      />
                    </svg>
                  </div>
                </div>

                <div class="mt-5 h-px w-full" style="background: linear-gradient(90deg, transparent, color-mix(in srgb, var(--brand-200) 70%, transparent), transparent);"></div>

                <div class="mt-4 flex items-center gap-2 text-xs font-extrabold" style="color: color-mix(in srgb, var(--brand-800) 80%, transparent);">
                  <span class="h-2 w-2 rounded-full bg-[var(--brand-500)]"></span>
                  Si es súbito o progresivo, acude a urgencias.
                </div>
              </div>

              <!-- Sections quick nav -->
              <div class="rounded-[2rem] bg-white/70 backdrop-blur-xl shadow-sm p-6"
                   style="border: 1px solid color-mix(in srgb, var(--brand-200) 45%, transparent);">
                <h3 class="text-sm font-extrabold" style="color: var(--brand-950);">Secciones</h3>
                <div class="mt-3 flex flex-wrap gap-2">
                  <a
                    [routerLink]="[]"
                    fragment="sintomas"
                    class="rounded-full bg-white/85 px-3 py-1.5 text-sm font-extrabold hover:opacity-80 transition"
                    style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: color-mix(in srgb, var(--brand-800) 80%, transparent);"
                  >
                    Síntomas
                  </a>
                  <a
                    [routerLink]="[]"
                    fragment="tratamientos"
                    class="rounded-full bg-white/85 px-3 py-1.5 text-sm font-extrabold hover:opacity-80 transition"
                    style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: color-mix(in srgb, var(--brand-800) 80%, transparent);"
                  >
                    Tratamientos
                  </a>
                  <a
                    [routerLink]="[]"
                    fragment="faq"
                    class="rounded-full bg-white/85 px-3 py-1.5 text-sm font-extrabold hover:opacity-80 transition"
                    style="border: 1px solid color-mix(in srgb, var(--brand-200) 55%, transparent); color: color-mix(in srgb, var(--brand-800) 80%, transparent);"
                  >
                    Preguntas
                  </a>
                </div>
              </div>
            </aside>
          </div>

        } @else {
          <div class="text-center py-24" style="color: var(--brand-600);">Cargando…</div>
        }

      }
    }
  </div>
</section>
